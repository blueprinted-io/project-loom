{% extends "base.html" %}
{% block content %}
<h1>Import JSON</h1>
<p>Upload a JSON file containing <code>tasks</code> and/or <code>workflows</code>.</p>

{% if error %}
  <div class="card" style="border-left: 4px solid #b00020;">
    <b>Error:</b> {{ error }}
  </div>
{% endif %}

<div class="card">
  <form method="post" action="/import/json" enctype="multipart/form-data">
    <div class="row">
      <label>JSON file</label>
      <input type="file" name="upload" accept="application/json,.json" required />
    </div>

    <div class="row">
      <label>Actor note</label>
      <input type="text" name="actor_note" value="Imported from JSON" />
    </div>

    <button class="btn" type="submit">Import</button>
  </form>
</div>

<div class="card">
  <h2>Expected shape (example)</h2>
  <pre style="white-space:pre-wrap">{
  "tasks": [
    {
      "type": "task",
      "title": "...",
      "outcome": "...",
      "procedure_name": "...",
      "steps": [
        {"text": "Do X", "completion": "Confirm Y"}
      ],
      "facts": [],
      "concepts": [],
      "dependencies": []
    }
  ],
  "workflows": [
    {
      "type": "workflow",
      "title": "...",
      "objective": "...",
      "task_refs": [
        {"record_id": "...", "version": 1}
      ]
    }
  ]
}</pre>
</div>
{% endblock %}
